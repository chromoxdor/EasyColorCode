<!doctype html>

<title>CodeMirror: Espeasy Demo</title>
<meta charset="utf-8" />

<link rel="stylesheet" href="codemirror.css">
<script src="codemirror.js"></script>
<script src="espeasy.js"></script>
<script src="anyword-hint.js" id="anyword"></script>
<style>

</style>

<article>


  <textarea id="rules" name="rules" rows="30" wrap="off" style="display: none;">//this is a test
 
  dede on test3 do
  if [test#a]=1 and [test#b]=1 or [test#c]=0
  event,ok
  else
  event,not_ok
  endif
  endon
  on test4 {
  do
  if [test#a]=0
  event,ok
  else
  event,not_ok }
  endif endon

  on eventname2 do
  let,1,sq(%eventvalue1%)
  let,2,sqrt([var#1])
  let,3,=log(%eventvalue2%)
  let,4,ln(%eventvalue2%)
  LogEntry,'sqrt of [var#1] = [var#2]'
  LogEntry,'log of %eventvalue2% = [var#3]'
  LogEntry,'ln of %eventvalue2% = [var#4]'
endon
  
</textarea>
  <td>
    <a href="javascript:autoFormatSelection()">
      Autoformat Selected
    </a>
  </td>

  <script>
    function completeAfter(cm, pred) {
      if (navigator.userAgentData.mobile) { 
        var cur = cm.getCursor();
        if (!pred || pred()) setTimeout(function () {
          if (!cm.state.completionActive)
            cm.showHint({ completeSingle: false });
        }, 100);
        return CodeMirror.Pass;
      } else { return CodeMirror.Pass; };
    }

    initCM();
   /* CodeMirror.commands.autocomplete = function (cm) { cm.showHint({ hint: CodeMirror.hint.anyword }); };
    var rEdit = CodeMirror.fromTextArea(document.getElementById('rules'), { lineNumbers: true, extraKeys: { "' '": completeAfter, 'Alt-Space': 'autocomplete' } }); rEdit.on('change', function () { rEdit.save() });

    CodeMirror.commands["selectAll"](rEdit);

    function getSelectedRange() {
      return { from: rEdit.getCursor(true), to: rEdit.getCursor(false) };
    }

    function autoFormatSelection() {
      var range = getSelectedRange();
      rEdit.autoFormatRange(range.from, range.to);
    }

    function commentSelection(isComment) {
      var range = getSelectedRange();
      rEdit.commentRange(isComment, range.from, range.to);
    }   */
  </script>